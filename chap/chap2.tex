% vim:ts=4:sw=4
% Copyright (c) 2014 Casper Ti. Vector
% Public domain.

\chapter{智能监控环境下多角度人脸检测}
人类的思维活动是以对客观世界的认识为基础的，感觉是人类的大脑与周围世界发生联系的窗口。人脑在每天的感知活动中要从3万个听觉神经和1万个视觉神经的输入中抽取出有意义的信息，其中，约有80\%的信息来自视觉。人脸检测(Face Detection)的目的是为了确定图像中人脸的位置、大小和数量，它是模式识别和计算机视觉领域中的重要研究方向。人脸检测最初被作为自动人脸识别系统的定位环节被提出，并因其重要性在 20 世纪 90 年代以后作为一个独立的课题而备受研究者们的关注，并提出大量的人脸检测算法。

\section{人脸检测研究概述}
人脸检测就是判断图片中是否有人脸存在,如果存在,则输出各个人脸的位置和大小。人脸检测是人脸识别的基础,如果人脸检测出现错误的话,后续的人脸识别基本无法进行。衡量人脸检测算法的好坏主要有以下三个指标:1.召回率,即正确检测到的脸的数量与数据库中总的脸的数量之比。这个指标反映了检测器可以正确找到多少人脸。2.精确度,即在所有输出的人脸中,正确的人脸所占的比例。这个指标反映了检测器检出结果的可靠程度。3.稳定度,即当人脸在图片中的位置和大小发生变化时,输出的人脸位置和大小也需要相对于真实人脸保持不变,一般用标注的位置和检测到的位置的重合度来衡量。越稳定的人脸检测结果对于后序的人脸校准操作越有利。这三个指标越高,人脸检测算法越好。到目前为止,最具有里程碑意义的人脸检测算法是文章[3],它奠定了现代人脸检测算法的基础。为了解决[3]不能很好的处理多角度的问题,随后也出现了许多其他经典的人脸检测算法,如文章[4-12]等。有关人脸检测技术的发展,读者可以参考综述文章[13]。

早期的人脸检测和识别技术研究主要针对正面、简单背景下的人脸图像。然而，人脸图像易受如下自身的可变因素和外界条件的影响：(1) 外貌、表情、肤色等的不同，使人脸具有模式可变性；(2) 光照的影响，曝光及外在光源等引起的图像中亮度、对比度的不同；(3) 眼镜、头发和饰物以及其它外部物体等引起面部图像的部分遮挡；(4) 人脸与摄像头之间的相对运动引起人脸姿态的多样性，如平面内旋转、平面外偏转及俯仰等变化。不同姿态下的二维图像投影引起的三维脸部不同部位的拉伸和压缩及遮挡，这样即使是同一个人在不同姿态下的二维人脸图像也存在较大差异[3]；(5) 摄像设备性能的不同、相机焦距、噪声等引起的成像条件差异；(6) 复杂背景对人脸目标的干扰。受这些因素的影响，图像中人脸的模式存在很强的多样性，这使得复杂环境下的人脸检测和识别是一个极富挑战性的研究课题[4]。随着机器学习等人工智能方法的引入，人脸的检测和识别算法可以通过自适应的学习训练数据中的知识，逐步提高解决复杂背景下的人脸检测和识别的能力。因而，本文致力于采用机器学习的方法解决复杂背景下的多姿态人脸检测与识别问题。由于人脸的姿态变化和观察视角的不同是相对的，所以在本文中姿态和视角是相互通用的。

统计表明75\%的家庭照片中的人脸并非正面人脸，并且在实际应用中由于人体的运动或摄像设备的移动，使得正面人脸图像的获取比较困难。另外在智能监控视频当中，由于摄像头位置和角度问题，检测的人脸大多为非正面。为此多姿态人脸检测算法受到越来越多的关注。Rowley将Viola的方法推广到多视角人脸检测，针对不同角度训练多个网络，并采用姿态预估计加快检测速度；Schneiderman等[5]将人脸划分为左侧面、正面和右侧面，分别训练了三个不同视图的检测器来分别处理这三种情况；Li等[9]则用SVM进行多姿态人脸的检测和识别；Feraud等[10]采用Constrained Generative Model构造了四个人脸检测器分别针对左右偏转$[0^\circ,20^\circ]$和$[20^\circ,40^\circ]$的人脸进行检测。Li等[11]手动的将人脸训练样本分成几个较均匀的子视角类，然后通过提出的Floatboost学习方法，训练得到“由粗到细”的金字塔型结构人脸检测器，用于近乎实时的多视角人脸检测。

人脸特征表示的好坏,直接关系到了人脸检测与识别的精度的高低。因此,如何得到具有表达力的人脸特征,就是人脸检测与识别的最关键的问题。纵观30多年的人脸识别的研究历史,我们发现人脸识别技术的发展本质上也就是人脸特征的发展,更多有关人脸识别技术的发展历史,读者可以参考综述文章[1,2]。特征提取的作用就是根据已知的人脸的位置信息,提取出对于人脸识别有利的信息,如面部区域、纹理结构等,而去掉和人脸识别无关的,如背景、噪声等信息。一个优秀的人脸特征需要满足以下两个要求:1.该特征需要对不同人之间的细微区别十分敏感。2.同时,该特征需要对人脸角度、光照、表情等变化具有一定的不变性。目前人脸识别技术中,运用的最多的特征有以下几种LBP[18]，SIFT [19]，HOG[]，Gabor[20]，LE [21]等,这些特征在广泛的应用中均取得了不错的识别精度。目前,由于深度学习(deep learning)的发展,也有许多基于深度学习的算法将特征提取和特征学习融合到同一个框架中,其中包括:DeepFace[25]、DeepID [26]、FaceNet [27]等。由于深度神经网络强大的拟合能力,这类方法在各种人脸识别问题中均取得了十分优秀的结果。但是由于这类方法网络结构复杂,模型参数一般都在百万量级。模型大小一般为几百兆,在实际使用中不太方便。另外,这类方法需要硬件支持并行计算,不适合手机或嵌入式系统上的人脸识别。因此,深度学习算法一般运用在云计算中。目前有许多公司提供基于深度学习的人脸云计算服务,例如:Face++,Microsoft Project,SenseTime,Oxford 等。

\section{人脸检测和识别中的特征}
\subsection{Haar-Like特征}
\subsection{LBP特征}
\subsection{HOG特征}
\subsection{SIFT特征}
\subsection{非手工设计特征}
\section{基于类Haar特征的AdaBoost人脸检测}
\section{基于可变型部件模型的人脸检测}
\section{本章小结}